#!/usr/bin/env python
# -*- coding: utf-8 -*-

BMREQUESTTYPE = (
    0x90, 0xF0, 0xB8, 0xE0, # mov DPTR, #0xF0B8 \ movx a, @DPTR
    0x90, None, None, 0xF0, # mov DPTR, #0x???? \ movx @DPTR, a
    0x90, 0xF0, 0xB9, 0xE0  # mov DPTR, #0xF0B9 \ movx a, @DPTR \ movx DPTR, #0x????
)

SCSI_CDB = (
    0x90, None, None, 0xE0, # mov DPTR, #0x???? \ movx a, @DPTR
    0xB4, 0x28 # cjne A, #0x28, ????
)

SCSI_TAG = (
    0x90, 0xF2, 0x1C, # mov DPTR, #0xF21C
    0x74, 0x55, 0xF0, # mov A, #0x55 \ movx @DPTR, A
    0x74, 0x53, 0xF0, # mov A, #0x53 \ movx @DPTR, A
    0x74, 0x42, 0xF0, # mov A, #0x42 \ movx @DPTR, A
    0x74, 0x53, 0xF0, # mov A, #0x53 \ movx @DPTR, A
    0x90 # mov DPTR, #0x????
)

FW_EPIRQ = (
    0xC0, 0xE0, 0xC0, 0x83, 0xC0, 0x82, # push ACC \ push DPH \ push DPL
    0x90, 0xF0, 0x20, 0xE0, # mov DPTR, #0xF020 \ movx A, @DPTR
    0x30, 0xE1, None, # jnb ACC.1, ????
    0x12, None, None, 0x90 # lcall ???? \ mov DPTR, #0x????
)

OFFPAGE_CALL = (
    0xC0, 0x5B, 0x74, 0x08, # push RAM_5B \ mov A, #8
    0xC0, 0xE0, 0xC0, 0x82, 0xC0, 0x83, # push ACC \ push DPL \ push DPH
    0x75, 0x5B # mov RAM_5B, #0x??
)

CONTROL_REQUEST_HANDLER = (
    0x12, None, None, # lcall #0x????
    0x90, 0xFE, 0x82, 0xE0, # mov DPTR, #0xFE82 \ movx A, @DPTR
    0x54, 0xEF, 0xF0 # anl A, #0xEF \ movx @DPTR, A
)

ENDPOINT_INTERRUPT_HANDLER = (
    0x30, 0xE1, None, # jnb ACC.1, #0x????
    0x12, None, None, # lcall #0x????
    0x90, 0xFE, 0x82, 0xE0, # mov DPTR, #0xFE82 \ movx A, @DPTR
    0x54, 0xEF, 0xF0 # anl A, #0xEF \ movx @DPTR, A
)

CDB_HANDLER = (
    0x90, None, None, 0xE0, # mov DPTR, #0x???? \ movx a, @DPTR
    0xB4, 0x28 # cjne A, #0x28, ????
)

MAIN_LOOP = (
    0x90, None, None, 0xE0, # mov DPTR, #0x???? \ movx A, @DPTR
    0xB4, 0x01, None, # cjne A, #1, #0x????
    0x90, 0xF0, 0x79 # mov DPTR, #0xF079
)

PASSWORD_HANDLER = (
    0x90, 0xF2, 0x4C, 0xF0, 0xA3, # mov DPTR, #0xF24C \ movx @DPTR, A \ inc DPTR
    0xC0, 0x83, 0xC0, 0x82, 0x12, # push DPH \ push DPL
    None, None, 0xD0, 0x82, 0xD0, 0x83, 0xF0, # lcall #0x???? \ pop DPL \ pop DPH \ movx @DPTR, A
    0x90, 0xF2, 0x53, 0x74, 0x80, 0xF0, # mov DPTR, #0xF253 \ mov A, #0x80 \ movx @DPTR, A
    0x90, 0xF2, 0x53, 0xE0, # mov DPTR, #0xF253 \ movx A, @DPTR
    0x30, 0xE7, None, # jnb ACC.7, #0x????
    0x12, None, None, 0x40, None, # lcall #0x???? \ jc #0x????
    0x12, None, None, 0x7F, 0x00, 0x22 # lcall #0x???? \ mov R7, #0 \ ret
)
